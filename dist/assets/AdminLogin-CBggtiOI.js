import{E as y,b as N,e as S,r as p,j as e,t as A}from"./index-CEFGCZnp.js";import{C,c as L,d as v,e as E,a as I,b as R}from"./card-DsqFjwao.js";import{I as x}from"./input-DqKHY6Ez.js";import{B as P}from"./button-C58ynU3B.js";import{u as q,F as B,a as f,b as h,c as g,d as j,e as w}from"./form-BHEubM8M.js";import{t as D,z as c}from"./zod-CzPxuAgn.js";import{S as T}from"./scroll-reveal-BS9ME4tk.js";import{L as z}from"./loader-circle-B1Pz0Ua7.js";import"./label-C9OSIm7g.js";const H=c.object({email:c.string().min(1,{message:"Please enter your email or username"}),password:c.string().min(1,{message:"Please enter your password"})}),X=()=>{const{login:b,isLoading:a,isAuthenticated:i,needsTwoFactor:t}=y(),r=N(),l=S(),[m,d]=p.useState(!1),o=q({resolver:D(H),defaultValues:{email:"",password:""}});p.useEffect(()=>{var s;if(console.log("Login page auth state:",{isAuthenticated:i,needsTwoFactor:t,isLoading:a}),i&&!a&&!t){console.log("Already authenticated, redirecting to admin dashboard");const n=((s=l.state)==null?void 0:s.from)||"/admin";r(n,{replace:!0})}else t&&!a&&(console.log("2FA required, redirecting to verification page"),r("/admin/two-factor",{replace:!0}))},[i,a,t,r,l]);const F=async s=>{var n;console.log("Login attempt with",s),d(!0);try{if(await b(s.email,s.password))if(t)console.log("Redirecting to 2FA"),r("/admin/two-factor",{replace:!0});else{const u=((n=l.state)==null?void 0:n.from)||"/admin";console.log("Redirecting to:",u),r(u,{replace:!0})}else console.log("Authentication failed"),A({variant:"destructive",title:"Authentication failed",description:"Invalid username/email or password."})}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen bg-secondary/30 flex items-center justify-center p-4",children:e.jsx(T,{children:e.jsxs(C,{className:"w-full max-w-md",children:[e.jsxs(L,{className:"space-y-1",children:[e.jsx(v,{className:"text-2xl font-bold text-center",children:"Admin Login"}),e.jsx(E,{className:"text-center",children:"Enter your credentials to access the admin panel"})]}),e.jsx(I,{children:e.jsx(B,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(F),className:"space-y-4",children:[e.jsx(f,{control:o.control,name:"email",render:({field:s})=>e.jsxs(h,{children:[e.jsx(g,{children:"Email or Username"}),e.jsx(j,{children:e.jsx(x,{placeholder:"admin@example.com or admin",...s})}),e.jsx(w,{})]})}),e.jsx(f,{control:o.control,name:"password",render:({field:s})=>e.jsxs(h,{children:[e.jsx(g,{children:"Password"}),e.jsx(j,{children:e.jsx(x,{type:"password",placeholder:"••••••••",...s})}),e.jsx(w,{})]})}),e.jsxs(P,{type:"submit",className:"w-full",disabled:a||m,children:[(a||m)&&e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign in"]})]})})}),e.jsx(R,{className:"flex flex-col",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center mt-2",children:"For demo purposes: use admin / ASDqwe123#"})})]})})})};export{X as default};
