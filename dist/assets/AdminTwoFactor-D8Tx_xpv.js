import{c as Oe,r as e,j as i,z as X,E as Ie,b as De,t as pe}from"./index-CEFGCZnp.js";import{C as Ae,c as Be,d as We,e as Fe,a as Le}from"./card-DsqFjwao.js";import{B as _e}from"./button-C58ynU3B.js";import{S as He}from"./scroll-reveal-BS9ME4tk.js";import{L as me}from"./loader-circle-B1Pz0Ua7.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=Oe("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);var Ge=Object.defineProperty,ze=Object.defineProperties,Ve=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,fe=(r,t,a)=>t in r?Ge(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,qe=(r,t)=>{for(var a in t||(t={}))ve.call(t,a)&&fe(r,a,t[a]);if(Y)for(var a of Y(t))he.call(t,a)&&fe(r,a,t[a]);return r},Ue=(r,t)=>ze(r,Ve(t)),Je=(r,t)=>{var a={};for(var s in r)ve.call(r,s)&&t.indexOf(s)<0&&(a[s]=r[s]);if(r!=null&&Y)for(var s of Y(r))t.indexOf(s)<0&&he.call(r,s)&&(a[s]=r[s]);return a},Ke="^\\d+$";function Qe(r){let t=setTimeout(r,0),a=setTimeout(r,10),s=setTimeout(r,50);return[t,a,s]}function Xe(r){let t=e.useRef();return e.useEffect(()=>{t.current=r}),t.current}var Ye=18,ge=40,Ze=`${ge}px`,et=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function tt({containerRef:r,inputRef:t,pushPasswordManagerStrategy:a,isFocused:s}){let v=e.useRef({done:!1,refocused:!1}),[u,S]=e.useState(!1),[h,B]=e.useState(!1),[g,k]=e.useState(!1),W=e.useMemo(()=>a==="none"?!1:(a==="increase-width"||a==="experimental-no-flickering")&&u&&h,[u,h,a]),T=e.useCallback(()=>{let x=r.current,m=t.current;if(!x||!m||g||a==="none")return;let o=x,E=o.getBoundingClientRect().left+o.offsetWidth,F=o.getBoundingClientRect().top+o.offsetHeight/2,J=E-Ye,K=F;if(!(document.querySelectorAll(et).length===0&&document.elementFromPoint(J,K)===x)&&(S(!0),k(!0),!v.current.refocused&&document.activeElement===m)){let $=[m.selectionStart,m.selectionEnd];m.blur(),m.focus(),m.setSelectionRange($[0],$[1]),v.current.refocused=!0}},[r,t,g,a]);return e.useEffect(()=>{let x=r.current;if(!x||a==="none")return;function m(){let E=window.innerWidth-x.getBoundingClientRect().right;B(E>=ge)}m();let o=setInterval(m,1e3);return()=>{clearInterval(o)}},[r,a]),e.useEffect(()=>{let x=s||document.activeElement===t.current;if(a==="none"||!x)return;let m=setTimeout(T,0),o=setTimeout(T,2e3),E=setTimeout(T,5e3),F=setTimeout(()=>{k(!0)},6e3);return()=>{clearTimeout(m),clearTimeout(o),clearTimeout(E),clearTimeout(F)}},[t,s,a,T]),{hasPWMBadge:u,willPushPWMBadge:W,PWM_BADGE_SPACE_WIDTH:Ze}}var xe=e.createContext({}),be=e.forwardRef((r,t)=>{var a=r,{value:s,onChange:v,maxLength:u,textAlign:S="left",pattern:h=Ke,inputMode:B="numeric",onComplete:g,pushPasswordManagerStrategy:k="increase-width",containerClassName:W,noScriptCSSFallback:T=nt,render:x,children:m}=a,o=Je(a,["value","onChange","maxLength","textAlign","pattern","inputMode","onComplete","pushPasswordManagerStrategy","containerClassName","noScriptCSSFallback","render","children"]),E,F,J,K,$;let[Ee,je]=e.useState(typeof o.defaultValue=="string"?o.defaultValue:""),p=s??Ee,N=Xe(p),G=e.useCallback(n=>{v==null||v(n),je(n)},[v]),y=e.useMemo(()=>h?typeof h=="string"?new RegExp(h):h:null,[h]),d=e.useRef(null),Z=e.useRef(null),ee=e.useRef({value:p,onChange:G,isIOS:typeof window<"u"&&((F=(E=window==null?void 0:window.CSS)==null?void 0:E.supports)==null?void 0:F.call(E,"-webkit-touch-callout","none"))}),Q=e.useRef({prev:[(J=d.current)==null?void 0:J.selectionStart,(K=d.current)==null?void 0:K.selectionEnd,($=d.current)==null?void 0:$.selectionDirection]});e.useImperativeHandle(t,()=>d.current,[]),e.useEffect(()=>{let n=d.current,l=Z.current;if(!n||!l)return;ee.current.value!==n.value&&ee.current.onChange(n.value),Q.current.prev=[n.selectionStart,n.selectionEnd,n.selectionDirection];function f(){if(document.activeElement!==n){V(null),q(null);return}let c=n.selectionStart,w=n.selectionEnd,C=n.selectionDirection,O=n.maxLength,I=n.value,H=Q.current.prev,P=-1,M=-1,D;if(I.length!==0&&c!==null&&w!==null){let Te=c===w,Ne=c===I.length&&I.length<O;if(Te&&!Ne){let A=c;if(A===0)P=0,M=1,D="forward";else if(A===O)P=A-1,M=A,D="backward";else if(O>1&&I.length>1){let re=0;if(H[0]!==null&&H[1]!==null){D=A<H[1]?"backward":"forward";let Re=H[0]===H[1]&&H[0]<O;D==="backward"&&!Re&&(re=-1)}P=re+A,M=re+A+1}}P!==-1&&M!==-1&&P!==M&&d.current.setSelectionRange(P,M,D)}let ue=P!==-1?P:c,de=M!==-1?M:w,ke=D??C;V(ue),q(de),Q.current.prev=[ue,de,ke]}if(document.addEventListener("selectionchange",f,{capture:!0}),f(),document.activeElement===n&&te(!0),!document.getElementById("input-otp-style")){let c=document.createElement("style");if(c.id="input-otp-style",document.head.appendChild(c),c.sheet){let w="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";U(c.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),U(c.sheet,`[data-input-otp]:autofill { ${w} }`),U(c.sheet,`[data-input-otp]:-webkit-autofill { ${w} }`),U(c.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),U(c.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let b=()=>{l&&l.style.setProperty("--root-height",`${n.clientHeight}px`)};b();let j=new ResizeObserver(b);return j.observe(n),()=>{document.removeEventListener("selectionchange",f,{capture:!0}),j.disconnect()}},[]);let[ae,le]=e.useState(!1),[z,te]=e.useState(!1),[R,V]=e.useState(null),[L,q]=e.useState(null);e.useEffect(()=>{Qe(()=>{var n,l,f,b;(n=d.current)==null||n.dispatchEvent(new Event("input"));let j=(l=d.current)==null?void 0:l.selectionStart,c=(f=d.current)==null?void 0:f.selectionEnd,w=(b=d.current)==null?void 0:b.selectionDirection;j!==null&&c!==null&&(V(j),q(c),Q.current.prev=[j,c,w])})},[p,z]),e.useEffect(()=>{N!==void 0&&p!==N&&N.length<u&&p.length===u&&(g==null||g(p))},[u,g,N,p]);let _=tt({containerRef:Z,inputRef:d,pushPasswordManagerStrategy:k,isFocused:z}),oe=e.useCallback(n=>{let l=n.currentTarget.value.slice(0,u);if(l.length>0&&y&&!y.test(l)){n.preventDefault();return}typeof N=="string"&&l.length<N.length&&document.dispatchEvent(new Event("selectionchange")),G(l)},[u,G,N,y]),ie=e.useCallback(()=>{var n;if(d.current){let l=Math.min(d.current.value.length,u-1),f=d.current.value.length;(n=d.current)==null||n.setSelectionRange(l,f),V(l),q(f)}te(!0)},[u]),se=e.useCallback(n=>{var l,f;let b=d.current;if(!ee.current.isIOS||!n.clipboardData||!b)return;let j=n.clipboardData.getData("text/plain");n.preventDefault();let c=(l=d.current)==null?void 0:l.selectionStart,w=(f=d.current)==null?void 0:f.selectionEnd,C=(c!==w?p.slice(0,c)+j+p.slice(w):p.slice(0,c)+j+p.slice(c)).slice(0,u);if(C.length>0&&y&&!y.test(C))return;b.value=C,G(C);let O=Math.min(C.length,u-1),I=C.length;b.setSelectionRange(O,I),V(O),q(I)},[u,G,y,p]),Ce=e.useMemo(()=>({position:"relative",cursor:o.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[o.disabled]),ce=e.useMemo(()=>({position:"absolute",inset:0,width:_.willPushPWMBadge?`calc(100% + ${_.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:_.willPushPWMBadge?`inset(0 ${_.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:S,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[_.PWM_BADGE_SPACE_WIDTH,_.willPushPWMBadge,S]),Pe=e.useMemo(()=>e.createElement("input",Ue(qe({autoComplete:o.autoComplete||"one-time-code"},o),{"data-input-otp":!0,"data-input-otp-mss":R,"data-input-otp-mse":L,inputMode:B,pattern:y==null?void 0:y.source,style:ce,maxLength:u,value:p,ref:d,onPaste:n=>{var l;se(n),(l=o.onPaste)==null||l.call(o,n)},onChange:oe,onMouseOver:n=>{var l;le(!0),(l=o.onMouseOver)==null||l.call(o,n)},onMouseLeave:n=>{var l;le(!1),(l=o.onMouseLeave)==null||l.call(o,n)},onFocus:n=>{var l;ie(),(l=o.onFocus)==null||l.call(o,n)},onBlur:n=>{var l;te(!1),(l=o.onBlur)==null||l.call(o,n)}})),[oe,ie,se,B,ce,u,L,R,o,y==null?void 0:y.source,p]),ne=e.useMemo(()=>({slots:Array.from({length:u}).map((n,l)=>{let f=z&&R!==null&&L!==null&&(R===L&&l===R||l>=R&&l<L),b=p[l]!==void 0?p[l]:null;return{char:b,isActive:f,hasFakeCaret:f&&b===null}}),isFocused:z,isHovering:!o.disabled&&ae}),[z,ae,u,L,R,o.disabled,p]),Me=e.useMemo(()=>x?x(ne):e.createElement(xe.Provider,{value:ne},m),[m,ne,x]);return e.createElement(e.Fragment,null,T!==null&&e.createElement("noscript",null,e.createElement("style",null,T)),e.createElement("div",{ref:Z,"data-input-otp-container":!0,style:Ce,className:W},Me,e.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Pe)))});be.displayName="Input";function U(r,t){try{r.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var nt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const we=e.forwardRef(({className:r,containerClassName:t,...a},s)=>i.jsx(be,{ref:s,containerClassName:X("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:X("disabled:cursor-not-allowed",r),...a}));we.displayName="InputOTP";const ye=e.forwardRef(({className:r,...t},a)=>i.jsx("div",{ref:a,className:X("flex items-center",r),...t}));ye.displayName="InputOTPGroup";const Se=e.forwardRef(({index:r,className:t,...a},s)=>{const v=e.useContext(xe),{char:u,hasFakeCaret:S,isActive:h}=v.slots[r];return i.jsxs("div",{ref:s,className:X("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",h&&"z-10 ring-2 ring-ring ring-offset-background",t),...a,children:[u,S&&i.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:i.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});Se.displayName="InputOTPSlot";const rt=e.forwardRef(({...r},t)=>i.jsx("div",{ref:t,role:"separator",...r,children:i.jsx($e,{})}));rt.displayName="InputOTPSeparator";const ct=()=>{const{verifyTwoFactor:r,isLoading:t,needsTwoFactor:a}=Ie(),s=De(),[v,u]=e.useState(""),[S,h]=e.useState(!1);e.useEffect(()=>{!a&&!t&&s("/admin/login")},[a,t,s]);const B=async g=>{g.preventDefault(),h(!0);try{if(v.length!==6){pe({variant:"destructive",title:"Invalid Code",description:"Please enter a 6-digit verification code"});return}await r(v)?s("/admin"):pe({variant:"destructive",title:"Invalid Code",description:"The verification code is incorrect. Please try again."})}finally{h(!1)}};return t?i.jsx("div",{className:"min-h-screen bg-secondary/30 flex items-center justify-center p-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx(me,{className:"h-8 w-8 animate-spin mx-auto"}),i.jsx("p",{className:"mt-2",children:"Loading authentication state..."})]})}):i.jsx("div",{className:"min-h-screen bg-secondary/30 flex items-center justify-center p-4",children:i.jsx(He,{children:i.jsxs(Ae,{className:"w-full max-w-md",children:[i.jsxs(Be,{className:"space-y-1",children:[i.jsx(We,{className:"text-2xl font-bold text-center",children:"Two-Factor Authentication"}),i.jsx(Fe,{className:"text-center",children:"Enter the 6-digit code from your authenticator app"})]}),i.jsx(Le,{children:i.jsxs("form",{onSubmit:B,className:"space-y-6",children:[i.jsx("div",{className:"flex justify-center py-4",children:i.jsx(we,{maxLength:6,value:v,onChange:g=>u(g),render:({slots:g})=>i.jsx(ye,{children:g.map((k,W)=>i.jsx(Se,{...k,index:W},W))})})}),i.jsxs(_e,{type:"submit",className:"w-full",disabled:t||S||v.length!==6,children:[t||S?i.jsx(me,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Verify"]}),i.jsx("p",{className:"text-sm text-muted-foreground text-center mt-4",children:"For demo purposes: enter any 6 digits to continue"})]})})]})})})};export{ct as default};
